<!doctype html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <title>Horoscope Print</title>
  
  <style>
    @font-face {
      font-family: 'NotoTamil';
      src: url('/fonts/NotoSansTamil-Regular.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }
    @page { size: A4; margin: 0; }
    html, body {
      margin: 0;
      padding: 0;
      width: 210mm;
      height: 297mm;
      font-family: 'NotoTamil', "Latha", serif;
      color: #000;
    }
    .sheet {
      box-sizing: border-box;
      position: relative;
      width: 210mm;
      height: 297mm;
      background: white;
      padding: 8mm;
    }
    
    /* Header section */
    .header {
      border: 2px solid #000;
      padding: 4mm;
      margin-bottom: 4mm;
    }
    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 3mm;
    }
    .astrologer-image {
      width: 22mm;
      height: 30mm;
      border: 1px solid #000;
      background: #f0f0f0;
    }
    .business-info {
      flex: 1;
      text-align: center;
      padding: 0 4mm;
    }
    .tamil-title {
      font-size: 10pt;
      margin-bottom: 2mm;
    }
    .business-name {
      font-size: 20pt;
      font-weight: bold;
      margin-bottom: 2mm;
    }
    .english-name {
      font-size: 11pt;
      margin-bottom: 1mm;
    }
    .phone-numbers {
      font-size: 10pt;
    }
    .address {
      text-align: right;
      font-size: 9pt;
      line-height: 1.4;
    }
    .timings-row {
      border-top: 1px solid #000;
      padding-top: 2mm;
      font-size: 10pt;
      font-weight: bold;
      text-align: center;
    }
    
    /* Personal details section */
    .details-section {
      border: 2px solid #000;
      padding: 3mm;
      margin-bottom: 4mm;
    }
    .details-row {
      display: flex;
      margin-bottom: 2mm;
      font-size: 10pt;
    }
    .details-label {
      font-weight: bold;
      min-width: 40mm;
    }
    .details-value {
      flex: 1;
    }
    
    /* Charts section */
    .charts {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4mm;
    }
    .chart {
      width: 48%;
      border: 2px solid #000;
      padding: 3mm;
    }
    .chart-title {
      text-align: center;
      font-weight: bold;
      font-size: 12pt;
      margin-bottom: 3mm;
    }
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 0;
      border: 1px solid #000;
      min-height: 80mm;
    }
    .chart-cell {
      border: 1px solid #000;
      padding: 2mm;
      font-size: 9pt;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      min-height: 20mm;
    }
    
    /* Footer section */
    .footer-section {
      border: 2px solid #000;
      padding: 3mm;
    }
    .footer-title {
      font-weight: bold;
      margin-bottom: 2mm;
      font-size: 10pt;
    }
    .footer-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 3mm;
      font-size: 9pt;
    }
    .footer-item {
      display: flex;
    }
    .footer-label {
      font-weight: bold;
      margin-right: 1mm;
    }
    .signature {
      margin-top: 3mm;
      font-size: 9pt;
    }
  </style>
</head>
<body>
  <div class="sheet">
    <!-- Header -->
    <div class="header">
      <div class="header-top">
        <div class="astrologer-image">
          <!-- Placeholder for astrologer image -->
        </div>
        <div class="business-info">
          <div class="tamil-title"><%= data.tamil_title || 'ஸ்ரீ காஞ்சி மஹா பெரியவா துணை' %></div>
          <div class="business-name"><%= data.business_name || 'பாலமணி ஜோதிட சேவை' %></div>
          <div class="english-name"><%= data.english_name || 'Er. M. நடராஜன்' %></div>
          <div class="phone-numbers"><%= data.phone_numbers || '97914 - 76676' %></div>
        </div>
        <div class="address">
          <%= data.address_line1 || '11, அண்ணாமலை நகர் மெயின் ரோடு,' %><br>
          <%= data.address_line2 || '(45Ft Road Patrol Bunk Opposite)' %><br>
          <%= data.address_line3 || 'சாரம், புதுச்சேரி – 605 013.' %>
        </div>
      </div>
      <div class="timings-row">
        சேவை விருப்பரை: <%= data.timings || 'காலை 9.30 - 12.00 / மாலை 4.00 - 6.00' %>
      </div>
    </div>
    
    <!-- Personal Details -->
    <div class="details-section">
      <div class="details-row">
        <div class="details-label">பெயர்:</div>
        <div class="details-value"><%= data.name || '' %></div>
        <div class="details-label">தமிழ் வருடம்:</div>
        <div class="details-value"><%= data.tamil_year || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">பிறந்த தேதி & நேரம்:</div>
        <div class="details-value"><%= data.birth_date || '' %> <%= data.birth_time || '' %></div>
        <div class="details-label">மாதம் / தேதி:</div>
        <div class="details-value"><%= data.tamil_month || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">பிறந்த இடம்:</div>
        <div class="details-value"><%= data.birth_place || '' %></div>
        <div class="details-label">சேவ்வாய் தோஷம்:</div>
        <div class="details-value"><%= data.sevvai_dosham || 'உண்டு / இல்லை' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">பிறந்த கிழமை:</div>
        <div class="details-value"><%= data.birth_day || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">வயது:</div>
        <div class="details-value"><%= data.age || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">ஜென்ம நட்சத்திரம்:</div>
        <div class="details-value"><%= data.star || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">ஜென்ம ராசி:</div>
        <div class="details-value"><%= data.rasi_name || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">ஜென்ம லக்னம்:</div>
        <div class="details-value"><%= data.lagnam || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">இருப்பு திசை:</div>
        <div class="details-value"><%= data.dasa || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">தற்கால திசை:</div>
        <div class="details-value"><%= data.current_dasa || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">கோசார குரு:</div>
        <div class="details-value"><%= data.guru || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">சனி:</div>
        <div class="details-value"><%= data.sani || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">பெற்றோர் விபரம்:</div>
        <div class="details-value"><%= data.parents || '' %></div>
      </div>
      <div class="details-row">
        <div class="details-label">விலாசம்:</div>
        <div class="details-value"><%= data.customer_address || '' %></div>
      </div>
    </div>
    
    <!-- Charts -->
    <div class="charts">
      <div class="chart">
        <div class="chart-title">இராசி</div>
        <div class="chart-grid">
          <% for(let i=1; i<=12; i++) { %>
            <div class="chart-cell"><%= (data.rasi && data.rasi[''+i]) ? data.rasi[''+i] : '' %></div>
          <% } %>
        </div>
      </div>
      <div class="chart">
        <div class="chart-title">நவாம்சம்</div>
        <div class="chart-grid">
          <% for(let i=1; i<=12; i++) { %>
            <div class="chart-cell"><%= (data.navamsa && data.navamsa[''+i]) ? data.navamsa[''+i] : '' %></div>
          <% } %>
        </div>
      </div>
    </div>
    
    <!-- Footer Details -->
    <div class="footer-section">
      <div class="footer-title">திருகண சாரங்கள்:</div>
      <div class="footer-grid">
        <div class="footer-item"><span class="footer-label">லக்னம்:</span> <%= data.footer_lagnam || '' %></div>
        <div class="footer-item"><span class="footer-label">குரு:</span> <%= data.footer_guru || '' %></div>
        <div class="footer-item"><span class="footer-label">ஆயிபான்:</span> <%= data.footer_aayipaan || '' %></div>
        <div class="footer-item"><span class="footer-label">பதன்:</span> <%= data.footer_pathan || '' %></div>
        <div class="footer-item"><span class="footer-label">அங்காரகன்:</span> <%= data.footer_angarakan || '' %></div>
        <div class="footer-item"><span class="footer-label">சுக்கிரன்:</span> <%= data.footer_sukkiran || '' %></div>
        <div class="footer-item"><span class="footer-label">சனி:</span> <%= data.footer_sani || '' %></div>
        <div class="footer-item"><span class="footer-label">கேது:</span> <%= data.footer_kethu || '' %></div>
        <div class="footer-item"><span class="footer-label">சந்திரன்:</span> <%= data.footer_chandran || '' %></div>
      </div>
      <div class="signature"></div>
    </div>
  </div>
</body>
</html>
